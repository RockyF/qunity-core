{"version":3,"file":"test2.js","sources":["../src/HashObject.ts","../src/ComponentManager.ts","../src/Entity.ts","../src/engine-config.ts","../src/Component.ts","test2.ts"],"sourcesContent":["/**\n * Created by rockyl on 2018/11/5.\n */\n\nlet HASH_CODE_INK: number = 0;\n\nfunction getHashCode() {\n\treturn ++HASH_CODE_INK;\n}\n\n/**\n * 哈希对象\n */\nexport class HashObject {\n\tprivate _hashCode: number;\n\t\n\tconstructor() {\n\t\tthis._hashCode = getHashCode();\n\t}\n\n\tget hashCode(): number {\n\t\treturn this._hashCode;\n\t}\n}\n","/**\n * Created by rockyl on 2019-07-29.\n */\n\nimport {Component} from \"./Component\";\nimport {Entity} from \"./Entity\";\n\n/**\n * 组件管理类\n */\nexport class ComponentManager{\n\tprivate _entity: Entity;\n\tprivate _components: Component[] = [];\n\tprivate _componentsNameMapping: any;\n\tprivate _componentsDefMapping: any;\n\n\tconstructor(entity: Entity){\n\t\tthis._entity = entity;\n\n\t\tthis.eachComponent(component => {\n\t\t\tcomponent.$setup(entity);\n\t\t})\n\t}\n\n\t/**\n\t * 遍历组件\n\t * @param callback\n\t */\n\teachComponent(callback: (component: Component, index: number) => unknown) {\n\t\tthis._components.some(callback);\n\t}\n\n\t/**\n\t * 当被创建时\n\t */\n\tonSetup() {\n\t\tthis.eachComponent(component => {\n\t\t\tcomponent.onSetup();\n\t\t})\n\t}\n\n\t/**\n\t * 当生效时\n\t */\n\tonAwake() {\n\t\tthis.eachComponent(component => {\n\t\t\tcomponent.onAwake();\n\t\t})\n\t}\n\n\t/**\n\t * 当失效时\n\t */\n\tonSleep() {\n\t\tthis.eachComponent(component => {\n\t\t\tcomponent.onSleep();\n\t\t})\n\t}\n\n\t/**\n\t * 时钟更新\n\t * @param t\n\t */\n\tonUpdate(t: number) {\n\t\tthis.eachComponent(component => {\n\t\t\tcomponent.onUpdate(t);\n\t\t})\n\t}\n\n\t/**\n\t * 当被销毁时\n\t */\n\tonDestroy() {\n\n\t}\n\n\t/**\n\t * 增加组件\n\t * @param component\n\t * @param index\n\t */\n\tadd(component: Component, index?: number) {\n\t\tif(component.entity && component.entity !== this._entity){\n\t\t\tconsole.warn('component.entity was not empty');\n\t\t\treturn;\n\t\t}\n\n\t\tif (index == undefined || index < 0 || index >= this._components.length) {\n\t\t\tindex = this._components.length;\n\t\t}\n\n\t\tif (component.entity == this._entity) {\n\t\t\tindex--;\n\t\t}\n\n\t\tconst currentIndex = this._components.indexOf(component);\n\t\tif (currentIndex == index) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (currentIndex >= 0) {\n\t\t\tthis._components.splice(currentIndex, 1);\n\t\t}\n\t\tthis._components.splice(index, 0, component);\n\n\t\tif(currentIndex < 0){\n\t\t\tthis.onAddComponent(component);\n\t\t}\n\t}\n\n\t/**\n\t * 移除组件\n\t * @param component\n\t */\n\tremove(component: Component) {\n\t\tthis.onRemoveComponent(component);\n\t\tconst index = this._components.indexOf(component);\n\t\tif (index >= 0) {\n\t\t\tthis._components.splice(index, 1);\n\t\t}\n\t}\n\n\t/**\n\t * 移除所有组件\n\t */\n\tremoveAll() {\n\t\twhile (this._components.length > 0) {\n\t\t\tthis.remove(this._components[0]);\n\t\t}\n\t}\n\n\t/**\n\t * 根据组件名称获取指定类的组件列表\n\t * @param name\n\t */\n\tfindByName<T extends Component>(name: string): T[] {\n\t\tlet components = this._componentsNameMapping[name];\n\t\tif(!components){\n\t\t\tcomponents = this._componentsNameMapping[name] = <T[]>this._components.filter((component: Component) => {\n\t\t\t\treturn component.constructor['__class__'] === name;\n\t\t\t});\n\t\t}\n\t\treturn components;\n\t}\n\n\t/**\n\t * 获取指定类的组件列表\n\t * @param clazz\n\t */\n\tfind<T extends Component>(clazz: new() => T): T[] {\n\t\tlet components = this._componentsDefMapping[clazz.name];\n\t\tif(!components){\n\t\t\tcomponents = this._componentsDefMapping[clazz.name] = <T[]>this._components.filter((component: Component) => {\n\t\t\t\treturn component instanceof clazz;\n\t\t\t});\n\t\t}\n\t\treturn components;\n\t}\n\n\t/**\n\t * 获取指定类的组件\n\t * @param name\n\t */\n\tgetByName<T extends Component>(name: string): T {\n\t\treturn this.findByName<T>(name)[0];\n\t}\n\n\t/**\n\t * 获取指定类的组件\n\t * @param clazz\n\t */\n\tgetOne<T extends Component>(clazz: new() => T): T {\n\t\treturn this.find<T>(clazz)[0];\n\t}\n\n\t/**\n\t * 获取所有组件\n\t */\n\tget all(): Component[] {\n\t\treturn this._components;\n\t}\n\n\t/**\n\t * 当添加组件时\n\t * @param component\n\t */\n\tprivate onAddComponent(component: Component) {\n\t\tthis._componentsNameMapping = {};\n\t\tthis._componentsDefMapping = {};\n\n\t\tcomponent.$setup(this._entity);\n\t\tthis.onAwake();\n\t}\n\n\t/**\n\t * 当移除组件时\n\t * @param component\n\t */\n\tprivate onRemoveComponent(component: Component) {\n\t\tthis._componentsNameMapping = {};\n\t\tthis._componentsDefMapping = {};\n\n\t\tcomponent.$unsetup();\n\t\tthis.onSleep();\n\t}\n}\n","/**\n * Created by rockyl on 2019-07-28.\n */\n\nimport {HashObject} from \"./HashObject\";\nimport {ComponentManager} from \"./ComponentManager\";\n\n/**\n * 实体类\n */\nexport class Entity extends HashObject {\n\tname: string;\n\n\tprivate _children: Entity[] = [];\n\tprivate _parent: Entity;\n\tprotected _enabled: boolean = false;\n\tprotected _isFree: boolean = true;\n\tprivate _components: ComponentManager;\n\n\t/**\n\t * 所有子实体\n\t */\n\tget children(): Entity[] {\n\t\treturn this._children;\n\t}\n\n\t/**\n\t * 父实体\n\t */\n\tget parent(): Entity {\n\t\treturn this._parent;\n\t}\n\n\t/**\n\t * 是否游离态\n\t */\n\tget isFree(): boolean {\n\t\treturn this._isFree;\n\t}\n\n\tget isActive(): boolean{\n\t\treturn !this._isFree && this._enabled\n\t}\n\n\t/**\n\t * 获取组件管理实例\n\t */\n\tget components(){\n\t\treturn this._components;\n\t}\n\n\t/**\n\t * 是否有效\n\t */\n\tget enabled(): boolean {\n\t\treturn this._enabled;\n\t}\n\n\tset enabled(value: boolean) {\n\t\tif (this._enabled != value) {\n\t\t\tthis._enabled = value;\n\t\t\tif(!this._isFree){\n\t\t\t\tif (this._enabled) {\n\t\t\t\t\tthis.validate();\n\t\t\t\t} else {\n\t\t\t\t\tthis.invalidate(true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 实例化实体\n\t * @param name\n\t */\n\tconstructor(name?: string) {\n\t\tsuper();\n\n\t\tif (name) {\n\t\t\tthis.name = name;\n\t\t}\n\t\tthis._components = new ComponentManager(this);\n\t}\n\n\t/**\n\t * 增加子实体\n\t * @param child\n\t * @param index\n\t */\n\taddChild(child: Entity, index?: number) {\n\t\tif (index == undefined || index < 0 || index >= this._children.length) {\n\t\t\tindex = this._children.length;\n\t\t}\n\n\t\tif (child._parent == this) {\n\t\t\tindex--;\n\t\t}\n\n\t\tthis.doAddChild(child, index);\n\t}\n\n\t/**\n\t * 移除子实体\n\t * @param child\n\t */\n\tremoveChild(child: Entity) {\n\t\tif (this.containsChild(child)) {\n\t\t\tchild._parent = null;\n\n\t\t\tlet index = this.getChildIndex(child);\n\t\t\tthis._children.splice(index, 1);\n\n\t\t\tif(!this._isFree){\n\t\t\t\tchild._free();\n\t\t\t\tif(this._enabled){\n\t\t\t\t\tchild.invalidate();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.onRemoveChild(child);\n\t\t}\n\t}\n\n\t/**\n\t * 通过索引移除实体\n\t * @param index\n\t */\n\tremoveChildAt(index: number) {\n\t\tlet child: Entity = this.getChildAt(index);\n\t\tif (child) {\n\t\t\tthis.removeChild(child);\n\t\t}\n\t}\n\n\t/**\n\t * 获取实体\n\t * @param index\n\t */\n\tgetChildAt(index: number): Entity {\n\t\treturn this._children[index];\n\t}\n\n\t/**\n\t * 获取子实体的索引\n\t * @param child\n\t */\n\tgetChildIndex(child: Entity): number {\n\t\treturn this._children.indexOf(child);\n\t}\n\n\t/**\n\t * 是否包含子实体\n\t * @param child\n\t */\n\tcontainsChild(child: Entity): boolean {\n\t\treturn child.parent == this;\n\t}\n\n\t/**\n\t * 遍历子实体\n\t * @param callback\n\t */\n\teachChild(callback: (child: Entity, index: number) => unknown) {\n\t\tthis._children.some(callback);\n\t}\n\n\tprivate doAddChild(child: Entity, index: number) {\n\t\tif (child == this) {\n\t\t\treturn;\n\t\t}\n\t\tlet parent = child.parent;\n\t\tif (parent) {\n\t\t\tif (parent == this) {\n\t\t\t\tlet currentIndex = this.getChildIndex(child);\n\t\t\t\tif (currentIndex != index) {\n\t\t\t\t\tthis._children.splice(currentIndex, 1);\n\t\t\t\t\tthis._children.splice(index, 0, child);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tparent.removeChild(child);\n\t\t\t}\n\t\t}\n\t\tif (!child.parent) {\n\t\t\tchild._parent = this;\n\t\t\tthis._children.splice(index, 0, child);\n\n\t\t\tif(!this._isFree){\n\t\t\t\tchild._restrict();\n\t\t\t\tif(this._enabled){\n\t\t\t\t\tchild.validate();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.onAddChild(child);\n\t\t}\n\t}\n\n\t/**\n\t * 使生效\n\t */\n\tprivate validate(force = false) {\n\t\tif (force || this._enabled) {\n\t\t\tthis.onEnable();\n\n\t\t\tthis.eachChild(child => {\n\t\t\t\tchild.validate();\n\t\t\t})\n\t\t}\n\t}\n\n\t/**\n\t * 使失效\n\t */\n\tprivate invalidate(force = false) {\n\t\tif (force || this._enabled) {\n\t\t\tthis.onDisable();\n\n\t\t\tthis.eachChild(child => {\n\t\t\t\tchild.invalidate();\n\t\t\t})\n\t\t}\n\t}\n\n\t/**\n\t * 使约束\n\t * @private\n\t */\n\tprivate _restrict() {\n\t\tthis._isFree = false;\n\t\tthis.eachChild(child => {\n\t\t\tchild._restrict();\n\t\t})\n\t}\n\n\t/**\n\t * 使游离\n\t * @param includeSelf\n\t */\n\tprivate _free(includeSelf = true) {\n\t\tthis._isFree = true;\n\t\tthis.eachChild(child => {\n\t\t\tchild._free();\n\t\t})\n\t}\n\n\t/**\n\t * 当实体生效时\n\t */\n\tprivate onEnable() {\n\t\tthis._components.onAwake();\n\t}\n\n\t/**\n\t * 当实体失效时\n\t */\n\tprivate onDisable() {\n\t\tthis._components.onSleep();\n\t}\n\n\t/**\n\t * 当添加子实体时\n\t * @param child\n\t */\n\tprivate onAddChild(child: Entity) {\n\n\t}\n\n\t/**\n\t * 当移除子实体时\n\t * @param child\n\t */\n\tprivate onRemoveChild(child: Entity) {\n\n\t}\n\n\n}\n\n/**\n * 根实体类\n */\nexport class RootEntity extends Entity{\n\tprotected _isFree: boolean = false;\n\tprotected _enabled: boolean = true;\n}\n","/**\n * Created by rockyl on 2018-12-05.\n *\n * 引擎配置\n */\n\nimport {injectProp} from \"./utils\";\n\n/**\n * 针对引擎的配置\n */\nexport const EngineConfig = {\n\t/**\n\t * 是否是编辑器模式\n\t */\n\teditorMode: false,\n};\n\n/**\n * 注入配置\n * @param _options\n */\nexport function modifyEngineConfig(_options) {\n\tinjectProp(EngineConfig, _options);\n}\n","/**\n * Created by rockyl on 2019-07-28.\n */\n\nimport {HashObject} from \"./HashObject\";\nimport {Entity} from \"./Entity\";\nimport {EngineConfig} from \"./engine-config\";\n\n/**\n * 组件类\n */\nexport class Component extends HashObject {\n\tprivate _entity: Entity;\n\tprivate _enabled: boolean = true;\n\n\tget entity(): Entity {\n\t\treturn this._entity;\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.onCreate();\n\t}\n\n\t/**\n\t * 是否有效\n\t */\n\tget enabled(): boolean {\n\t\treturn this._enabled;\n\t}\n\n\tset enabled(value: boolean) {\n\t\tif (this._enabled != value) {\n\t\t\tthis._enabled = value;\n\n\t\t\tif (this._entity && this._entity.isActive) {\n\t\t\t\tif (value) {\n\t\t\t\t\tthis.onEnable();\n\t\t\t\t} else {\n\t\t\t\t\tthis.onDisable();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t * @param entity\n\t */\n\t$setup(entity: Entity) {\n\t\tthis._entity = entity;\n\n\t\tif (!EngineConfig.editorMode) {\n\t\t\tthis.onSetup();\n\t\t}\n\t}\n\n\t$unsetup() {\n\t\tthis._entity = null;\n\t}\n\n\t/**\n\t * 当被创建时\n\t * 类似构造方法\n\t */\n\tonCreate() {\n\t\tconsole.log('onCreate');\n\t}\n\n\t/**\n\t * 当装配完成时\n\t *\n\t * 编辑器模式会在场景构造和属性注入完成后触发\n\t */\n\tonSetup() {\n\t\tconsole.log('onSetup');\n\t}\n\n\t/**\n\t * 当生效时\n\t * 仅当实体唤醒状态\n\t */\n\tonEnable() {\n\t\tconsole.log('onEnable');\n\t}\n\n\t/**\n\t * 当失效时\n\t * 仅当实体唤醒状态\n\t */\n\tonDisable() {\n\t\tconsole.log('onDisable');\n\t}\n\n\t/**\n\t * 当实体生效或组件被添加时\n\t */\n\tonAwake() {\n\t\tconsole.log('onAwake');\n\t}\n\n\t/**\n\t * 当实体失效或组件被移除时\n\t */\n\tonSleep() {\n\t\tconsole.log('onSleep');\n\t}\n\n\t/**\n\t * 时钟更新\n\t * @param t\n\t */\n\tonUpdate(t: number) {\n\t\tconsole.log('onUpdate');\n\t}\n\n\t/**\n\t * 当被销毁时\n\t */\n\tonDestroy() {\n\t\tconsole.log('onDestroy');\n\t}\n}\n","/**\n * Created by rockyl on 2019-07-30.\n */\n\nimport {Component, Entity, RootEntity} from \"../src\";\n\nlet root = new RootEntity('root');\n\nlet entity1 = new Entity('entity1');\nlet entity2 = new Entity('entity2');\nlet entity3 = new Entity('entity3');\n\nentity1.enabled = true;\nentity2.enabled = true;\nentity3.enabled = true;\n\nroot.addChild(entity1);\nentity1.addChild(entity2);\nentity2.addChild(entity3);\n\n//root.addChild(entity1);\n\nlet cp1 = new Component();\nentity1.components.add(cp1);\nentity1.components.remove(cp1);\nentity2.components.add(cp1);\ncp1.enabled = false;\n\nentity1.removeChild(entity2);\n/*entity2.enabled = false;\nentity2.enabled = true;\ncp1.enabled = true;*/\n//\n"],"names":["tslib_1.__extends"],"mappings":";;AAIA,IAAI,aAAa,GAAW,CAAC,CAAC;AAE9B,SAAS,WAAW;IACnB,OAAO,EAAE,aAAa,CAAC;CACvB;AAKD;IAGC;QACC,IAAI,CAAC,SAAS,GAAG,WAAW,EAAE,CAAC;KAC/B;IAED,sBAAI,gCAAQ;aAAZ;YACC,OAAO,IAAI,CAAC,SAAS,CAAC;SACtB;;;OAAA;IACF,iBAAC;CAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACbD;IAMC,0BAAY,MAAc;QAJlB,gBAAW,GAAgB,EAAE,CAAC;QAKrC,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QAEtB,IAAI,CAAC,aAAa,CAAC,UAAA,SAAS;YAC3B,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SACzB,CAAC,CAAA;KACF;IAMD,wCAAa,GAAb,UAAc,QAA0D;QACvE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KAChC;IAKD,kCAAO,GAAP;QACC,IAAI,CAAC,aAAa,CAAC,UAAA,SAAS;YAC3B,SAAS,CAAC,OAAO,EAAE,CAAC;SACpB,CAAC,CAAA;KACF;IAKD,kCAAO,GAAP;QACC,IAAI,CAAC,aAAa,CAAC,UAAA,SAAS;YAC3B,SAAS,CAAC,OAAO,EAAE,CAAC;SACpB,CAAC,CAAA;KACF;IAKD,kCAAO,GAAP;QACC,IAAI,CAAC,aAAa,CAAC,UAAA,SAAS;YAC3B,SAAS,CAAC,OAAO,EAAE,CAAC;SACpB,CAAC,CAAA;KACF;IAMD,mCAAQ,GAAR,UAAS,CAAS;QACjB,IAAI,CAAC,aAAa,CAAC,UAAA,SAAS;YAC3B,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;SACtB,CAAC,CAAA;KACF;IAKD,oCAAS,GAAT;KAEC;IAOD,8BAAG,GAAH,UAAI,SAAoB,EAAE,KAAc;QACvC,IAAG,SAAS,CAAC,MAAM,IAAI,SAAS,CAAC,MAAM,KAAK,IAAI,CAAC,OAAO,EAAC;YACxD,OAAO,CAAC,IAAI,CAAC,gCAAgC,CAAC,CAAC;YAC/C,OAAO;SACP;QAED,IAAI,KAAK,IAAI,SAAS,IAAI,KAAK,GAAG,CAAC,IAAI,KAAK,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE;YACxE,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;SAChC;QAED,IAAI,SAAS,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,EAAE;YACrC,KAAK,EAAE,CAAC;SACR;QAED,IAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QACzD,IAAI,YAAY,IAAI,KAAK,EAAE;YAC1B,OAAO;SACP;QAED,IAAI,YAAY,IAAI,CAAC,EAAE;YACtB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC;SACzC;QACD,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,SAAS,CAAC,CAAC;QAE7C,IAAG,YAAY,GAAG,CAAC,EAAC;YACnB,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;SAC/B;KACD;IAMD,iCAAM,GAAN,UAAO,SAAoB;QAC1B,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;QAClC,IAAM,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QAClD,IAAI,KAAK,IAAI,CAAC,EAAE;YACf,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;SAClC;KACD;IAKD,oCAAS,GAAT;QACC,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YACnC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;SACjC;KACD;IAMD,qCAAU,GAAV,UAAgC,IAAY;QAC3C,IAAI,UAAU,GAAG,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC;QACnD,IAAG,CAAC,UAAU,EAAC;YACd,UAAU,GAAG,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,GAAQ,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,UAAC,SAAoB;gBAClG,OAAO,SAAS,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,IAAI,CAAC;aACnD,CAAC,CAAC;SACH;QACD,OAAO,UAAU,CAAC;KAClB;IAMD,+BAAI,GAAJ,UAA0B,KAAiB;QAC1C,IAAI,UAAU,GAAG,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACxD,IAAG,CAAC,UAAU,EAAC;YACd,UAAU,GAAG,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,IAAI,CAAC,GAAQ,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,UAAC,SAAoB;gBACvG,OAAO,SAAS,YAAY,KAAK,CAAC;aAClC,CAAC,CAAC;SACH;QACD,OAAO,UAAU,CAAC;KAClB;IAMD,oCAAS,GAAT,UAA+B,IAAY;QAC1C,OAAO,IAAI,CAAC,UAAU,CAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;KACnC;IAMD,iCAAM,GAAN,UAA4B,KAAiB;QAC5C,OAAO,IAAI,CAAC,IAAI,CAAI,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;KAC9B;IAKD,sBAAI,iCAAG;aAAP;YACC,OAAO,IAAI,CAAC,WAAW,CAAC;SACxB;;;OAAA;IAMO,yCAAc,GAAtB,UAAuB,SAAoB;QAC1C,IAAI,CAAC,sBAAsB,GAAG,EAAE,CAAC;QACjC,IAAI,CAAC,qBAAqB,GAAG,EAAE,CAAC;QAEhC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC/B,IAAI,CAAC,OAAO,EAAE,CAAC;KACf;IAMO,4CAAiB,GAAzB,UAA0B,SAAoB;QAC7C,IAAI,CAAC,sBAAsB,GAAG,EAAE,CAAC;QACjC,IAAI,CAAC,qBAAqB,GAAG,EAAE,CAAC;QAEhC,SAAS,CAAC,QAAQ,EAAE,CAAC;QACrB,IAAI,CAAC,OAAO,EAAE,CAAC;KACf;IACF,uBAAC;CAAA,IAAA;;ACnMD;IAA4BA,0BAAU;IAiErC,gBAAY,IAAa;QAAzB,YACC,iBAAO,SAMP;QArEO,eAAS,GAAa,EAAE,CAAC;QAEvB,cAAQ,GAAY,KAAK,CAAC;QAC1B,aAAO,GAAY,IAAI,CAAC;QA8DjC,IAAI,IAAI,EAAE;YACT,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;SACjB;QACD,KAAI,CAAC,WAAW,GAAG,IAAI,gBAAgB,CAAC,KAAI,CAAC,CAAC;;KAC9C;IA5DD,sBAAI,4BAAQ;aAAZ;YACC,OAAO,IAAI,CAAC,SAAS,CAAC;SACtB;;;OAAA;IAKD,sBAAI,0BAAM;aAAV;YACC,OAAO,IAAI,CAAC,OAAO,CAAC;SACpB;;;OAAA;IAKD,sBAAI,0BAAM;aAAV;YACC,OAAO,IAAI,CAAC,OAAO,CAAC;SACpB;;;OAAA;IAED,sBAAI,4BAAQ;aAAZ;YACC,OAAO,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,QAAQ,CAAA;SACrC;;;OAAA;IAKD,sBAAI,8BAAU;aAAd;YACC,OAAO,IAAI,CAAC,WAAW,CAAC;SACxB;;;OAAA;IAKD,sBAAI,2BAAO;aAAX;YACC,OAAO,IAAI,CAAC,QAAQ,CAAC;SACrB;aAED,UAAY,KAAc;YACzB,IAAI,IAAI,CAAC,QAAQ,IAAI,KAAK,EAAE;gBAC3B,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;gBACtB,IAAG,CAAC,IAAI,CAAC,OAAO,EAAC;oBAChB,IAAI,IAAI,CAAC,QAAQ,EAAE;wBAClB,IAAI,CAAC,QAAQ,EAAE,CAAC;qBAChB;yBAAM;wBACN,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;qBACtB;iBACD;aACD;SACD;;;OAbA;IAiCD,yBAAQ,GAAR,UAAS,KAAa,EAAE,KAAc;QACrC,IAAI,KAAK,IAAI,SAAS,IAAI,KAAK,GAAG,CAAC,IAAI,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;YACtE,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;SAC9B;QAED,IAAI,KAAK,CAAC,OAAO,IAAI,IAAI,EAAE;YAC1B,KAAK,EAAE,CAAC;SACR;QAED,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;KAC9B;IAMD,4BAAW,GAAX,UAAY,KAAa;QACxB,IAAI,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE;YAC9B,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC;YAErB,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACtC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAEhC,IAAG,CAAC,IAAI,CAAC,OAAO,EAAC;gBAChB,KAAK,CAAC,KAAK,EAAE,CAAC;gBACd,IAAG,IAAI,CAAC,QAAQ,EAAC;oBAChB,KAAK,CAAC,UAAU,EAAE,CAAC;iBACnB;aACD;YAED,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;SAC1B;KACD;IAMD,8BAAa,GAAb,UAAc,KAAa;QAC1B,IAAI,KAAK,GAAW,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;QAC3C,IAAI,KAAK,EAAE;YACV,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SACxB;KACD;IAMD,2BAAU,GAAV,UAAW,KAAa;QACvB,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;KAC7B;IAMD,8BAAa,GAAb,UAAc,KAAa;QAC1B,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;KACrC;IAMD,8BAAa,GAAb,UAAc,KAAa;QAC1B,OAAO,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC;KAC5B;IAMD,0BAAS,GAAT,UAAU,QAAmD;QAC5D,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KAC9B;IAEO,2BAAU,GAAlB,UAAmB,KAAa,EAAE,KAAa;QAC9C,IAAI,KAAK,IAAI,IAAI,EAAE;YAClB,OAAO;SACP;QACD,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;QAC1B,IAAI,MAAM,EAAE;YACX,IAAI,MAAM,IAAI,IAAI,EAAE;gBACnB,IAAI,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBAC7C,IAAI,YAAY,IAAI,KAAK,EAAE;oBAC1B,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC;oBACvC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;iBACvC;aACD;iBAAM;gBACN,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;aAC1B;SACD;QACD,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;YAClB,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;YAEvC,IAAG,CAAC,IAAI,CAAC,OAAO,EAAC;gBAChB,KAAK,CAAC,SAAS,EAAE,CAAC;gBAClB,IAAG,IAAI,CAAC,QAAQ,EAAC;oBAChB,KAAK,CAAC,QAAQ,EAAE,CAAC;iBACjB;aACD;YAED,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;SACvB;KACD;IAKO,yBAAQ,GAAhB,UAAiB,KAAa;QAAb,sBAAA,EAAA,aAAa;QAC7B,IAAI,KAAK,IAAI,IAAI,CAAC,QAAQ,EAAE;YAC3B,IAAI,CAAC,QAAQ,EAAE,CAAC;YAEhB,IAAI,CAAC,SAAS,CAAC,UAAA,KAAK;gBACnB,KAAK,CAAC,QAAQ,EAAE,CAAC;aACjB,CAAC,CAAA;SACF;KACD;IAKO,2BAAU,GAAlB,UAAmB,KAAa;QAAb,sBAAA,EAAA,aAAa;QAC/B,IAAI,KAAK,IAAI,IAAI,CAAC,QAAQ,EAAE;YAC3B,IAAI,CAAC,SAAS,EAAE,CAAC;YAEjB,IAAI,CAAC,SAAS,CAAC,UAAA,KAAK;gBACnB,KAAK,CAAC,UAAU,EAAE,CAAC;aACnB,CAAC,CAAA;SACF;KACD;IAMO,0BAAS,GAAjB;QACC,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,IAAI,CAAC,SAAS,CAAC,UAAA,KAAK;YACnB,KAAK,CAAC,SAAS,EAAE,CAAC;SAClB,CAAC,CAAA;KACF;IAMO,sBAAK,GAAb,UAAc,WAAkB;QAC/B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACpB,IAAI,CAAC,SAAS,CAAC,UAAA,KAAK;YACnB,KAAK,CAAC,KAAK,EAAE,CAAC;SACd,CAAC,CAAA;KACF;IAKO,yBAAQ,GAAhB;QACC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;KAC3B;IAKO,0BAAS,GAAjB;QACC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;KAC3B;IAMO,2BAAU,GAAlB,UAAmB,KAAa;KAE/B;IAMO,8BAAa,GAArB,UAAsB,KAAa;KAElC;IAGF,aAAC;CA1QD,CAA4B,UAAU,GA0QrC;AAKD;IAAgCA,8BAAM;IAAtC;QAAA,qEAGC;QAFU,aAAO,GAAY,KAAK,CAAC;QACzB,cAAQ,GAAY,IAAI,CAAC;;KACnC;IAAD,iBAAC;CAHD,CAAgC,MAAM,GAGrC;;ACjRM,IAAM,YAAY,GAAG;IAI3B,UAAU,EAAE,KAAK;CACjB,CAAC;;ACLF;IAA+BA,6BAAU;IAQxC;QAAA,YACC,iBAAO,SAGP;QAVO,cAAQ,GAAY,IAAI,CAAC;QAShC,KAAI,CAAC,QAAQ,EAAE,CAAC;;KAChB;IARD,sBAAI,6BAAM;aAAV;YACC,OAAO,IAAI,CAAC,OAAO,CAAC;SACpB;;;OAAA;IAWD,sBAAI,8BAAO;aAAX;YACC,OAAO,IAAI,CAAC,QAAQ,CAAC;SACrB;aAED,UAAY,KAAc;YACzB,IAAI,IAAI,CAAC,QAAQ,IAAI,KAAK,EAAE;gBAC3B,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;gBAEtB,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;oBAC1C,IAAI,KAAK,EAAE;wBACV,IAAI,CAAC,QAAQ,EAAE,CAAC;qBAChB;yBAAM;wBACN,IAAI,CAAC,SAAS,EAAE,CAAC;qBACjB;iBACD;aACD;SACD;;;OAdA;IAoBD,0BAAM,GAAN,UAAO,MAAc;QACpB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QAEtB,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE;YAC7B,IAAI,CAAC,OAAO,EAAE,CAAC;SACf;KACD;IAED,4BAAQ,GAAR;QACC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;KACpB;IAMD,4BAAQ,GAAR;QACC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;KACxB;IAOD,2BAAO,GAAP;QACC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;KACvB;IAMD,4BAAQ,GAAR;QACC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;KACxB;IAMD,6BAAS,GAAT;QACC,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;KACzB;IAKD,2BAAO,GAAP;QACC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;KACvB;IAKD,2BAAO,GAAP;QACC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;KACvB;IAMD,4BAAQ,GAAR,UAAS,CAAS;QACjB,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;KACxB;IAKD,6BAAS,GAAT;QACC,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;KACzB;IACF,gBAAC;CAhHD,CAA+B,UAAU,GAgHxC;;ACrHD,IAAI,IAAI,GAAG,IAAI,UAAU,CAAC,MAAM,CAAC,CAAC;AAElC,IAAI,OAAO,GAAG,IAAI,MAAM,CAAC,SAAS,CAAC,CAAC;AACpC,IAAI,OAAO,GAAG,IAAI,MAAM,CAAC,SAAS,CAAC,CAAC;AACpC,IAAI,OAAO,GAAG,IAAI,MAAM,CAAC,SAAS,CAAC,CAAC;AAEpC,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC;AACvB,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC;AACvB,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC;AAEvB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AACvB,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AAC1B,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AAI1B,IAAI,GAAG,GAAG,IAAI,SAAS,EAAE,CAAC;AAC1B,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAC5B,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;AAC/B,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAC5B,GAAG,CAAC,OAAO,GAAG,KAAK,CAAC;AAEpB,OAAO,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC"}